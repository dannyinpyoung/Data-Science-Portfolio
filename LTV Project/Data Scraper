{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# LTV Regulation Policy Analysis: Bank of Ireland Mortgage Pool and Subprime Lending\n",
    "\n",
    "__The Data__\n",
    "The data used is scraped from the Bank of Ireland. It is in the format of a PDF, scraped, and then converted to a CSV for analysis on Excel. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Period</th>\n",
       "      <th>0% - 30%</th>\n",
       "      <th>30% - 40%</th>\n",
       "      <th>40%-50%</th>\n",
       "      <th>50%-60%</th>\n",
       "      <th>60%-70%</th>\n",
       "      <th>70%-80%</th>\n",
       "      <th>80%-90%</th>\n",
       "      <th>90%-95%</th>\n",
       "      <th>95% - 100%</th>\n",
       "      <th>100% - 125%</th>\n",
       "      <th>125% - 150%</th>\n",
       "      <th>150%</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>8.52%</td>\n",
       "      <td>7.20%</td>\n",
       "      <td>10.18%</td>\n",
       "      <td>12.69%</td>\n",
       "      <td>16.40%</td>\n",
       "      <td>22.11%</td>\n",
       "      <td>22.13%</td>\n",
       "      <td>0.66%</td>\n",
       "      <td>0.08%</td>\n",
       "      <td>0.03%</td>\n",
       "      <td>0.00%</td>\n",
       "      <td>0.00%</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>8.63%</td>\n",
       "      <td>7.35%</td>\n",
       "      <td>10.20%</td>\n",
       "      <td>12.82%</td>\n",
       "      <td>16.67%</td>\n",
       "      <td>22.13%</td>\n",
       "      <td>21.49%</td>\n",
       "      <td>0.60%</td>\n",
       "      <td>0.08%</td>\n",
       "      <td>0.04%</td>\n",
       "      <td>0.00%</td>\n",
       "      <td>0.00%</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>8.83%</td>\n",
       "      <td>7.52%</td>\n",
       "      <td>10.24%</td>\n",
       "      <td>13.06%</td>\n",
       "      <td>16.82%</td>\n",
       "      <td>21.99%</td>\n",
       "      <td>20.90%</td>\n",
       "      <td>0.53%</td>\n",
       "      <td>0.08%</td>\n",
       "      <td>0.04%</td>\n",
       "      <td>0.00%</td>\n",
       "      <td>0.00%</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>9.02%</td>\n",
       "      <td>7.69%</td>\n",
       "      <td>10.44%</td>\n",
       "      <td>13.18%</td>\n",
       "      <td>17.22%</td>\n",
       "      <td>21.75%</td>\n",
       "      <td>20.21%</td>\n",
       "      <td>0.38%</td>\n",
       "      <td>0.08%</td>\n",
       "      <td>0.03%</td>\n",
       "      <td>0.00%</td>\n",
       "      <td>0.00%</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>9.39%</td>\n",
       "      <td>7.84%</td>\n",
       "      <td>10.87%</td>\n",
       "      <td>13.46%</td>\n",
       "      <td>16.42%</td>\n",
       "      <td>21.64%</td>\n",
       "      <td>20.01%</td>\n",
       "      <td>0.22%</td>\n",
       "      <td>0.10%</td>\n",
       "      <td>0.05%</td>\n",
       "      <td>0.00%</td>\n",
       "      <td>0.00%</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>5</td>\n",
       "      <td>9.66%</td>\n",
       "      <td>7.99%</td>\n",
       "      <td>11.02%</td>\n",
       "      <td>13.66%</td>\n",
       "      <td>16.75%</td>\n",
       "      <td>21.54%</td>\n",
       "      <td>19.05%</td>\n",
       "      <td>0.21%</td>\n",
       "      <td>0.10%</td>\n",
       "      <td>0.03%</td>\n",
       "      <td>0.00%</td>\n",
       "      <td>0.00%</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>6</td>\n",
       "      <td>9.97%</td>\n",
       "      <td>8.18%</td>\n",
       "      <td>11.19%</td>\n",
       "      <td>13.79%</td>\n",
       "      <td>16.87%</td>\n",
       "      <td>21.51%</td>\n",
       "      <td>18.18%</td>\n",
       "      <td>0.19%</td>\n",
       "      <td>0.10%</td>\n",
       "      <td>0.02%</td>\n",
       "      <td>0.00%</td>\n",
       "      <td>0.00%</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>7</td>\n",
       "      <td>9.67%</td>\n",
       "      <td>7.80%</td>\n",
       "      <td>10.96%</td>\n",
       "      <td>13.39%</td>\n",
       "      <td>16.04%</td>\n",
       "      <td>21.39%</td>\n",
       "      <td>20.09%</td>\n",
       "      <td>0.34%</td>\n",
       "      <td>0.24%</td>\n",
       "      <td>0.08%</td>\n",
       "      <td>0.00%</td>\n",
       "      <td>0.00%</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>8</td>\n",
       "      <td>9.87%</td>\n",
       "      <td>7.98%</td>\n",
       "      <td>11.20%</td>\n",
       "      <td>13.46%</td>\n",
       "      <td>16.38%</td>\n",
       "      <td>21.13%</td>\n",
       "      <td>19.37%</td>\n",
       "      <td>0.31%</td>\n",
       "      <td>0.22%</td>\n",
       "      <td>0.08%</td>\n",
       "      <td>0.00%</td>\n",
       "      <td>0.00%</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>9</td>\n",
       "      <td>10.04%</td>\n",
       "      <td>8.16%</td>\n",
       "      <td>11.40%</td>\n",
       "      <td>13.62%</td>\n",
       "      <td>16.54%</td>\n",
       "      <td>21.08%</td>\n",
       "      <td>18.59%</td>\n",
       "      <td>0.29%</td>\n",
       "      <td>0.21%</td>\n",
       "      <td>0.08%</td>\n",
       "      <td>0.00%</td>\n",
       "      <td>0.00%</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>10</td>\n",
       "      <td>9.05%</td>\n",
       "      <td>7.55%</td>\n",
       "      <td>10.67%</td>\n",
       "      <td>13.17%</td>\n",
       "      <td>16.15%</td>\n",
       "      <td>21.92%</td>\n",
       "      <td>20.98%</td>\n",
       "      <td>0.26%</td>\n",
       "      <td>0.18%</td>\n",
       "      <td>0.06%</td>\n",
       "      <td>0.00%</td>\n",
       "      <td>0.00%</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>11</td>\n",
       "      <td>12.90%</td>\n",
       "      <td>10.42%</td>\n",
       "      <td>13.40%</td>\n",
       "      <td>16.76%</td>\n",
       "      <td>19.18%</td>\n",
       "      <td>18.86%</td>\n",
       "      <td>7.77%</td>\n",
       "      <td>0.40%</td>\n",
       "      <td>0.22%</td>\n",
       "      <td>0.08%</td>\n",
       "      <td>0.00%</td>\n",
       "      <td>0.00%</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>12</td>\n",
       "      <td>13.18%</td>\n",
       "      <td>10.57%</td>\n",
       "      <td>13.77%</td>\n",
       "      <td>17.02%</td>\n",
       "      <td>19.36%</td>\n",
       "      <td>18.47%</td>\n",
       "      <td>7.01%</td>\n",
       "      <td>0.35%</td>\n",
       "      <td>0.20%</td>\n",
       "      <td>0.07%</td>\n",
       "      <td>0.00%</td>\n",
       "      <td>0.00%</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>13</td>\n",
       "      <td>10.36%</td>\n",
       "      <td>8.38%</td>\n",
       "      <td>11.05%</td>\n",
       "      <td>13.79%</td>\n",
       "      <td>16.03%</td>\n",
       "      <td>20.29%</td>\n",
       "      <td>19.34%</td>\n",
       "      <td>0.41%</td>\n",
       "      <td>0.21%</td>\n",
       "      <td>0.13%</td>\n",
       "      <td>0.00%</td>\n",
       "      <td>0.00%</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>14</td>\n",
       "      <td>10.64%</td>\n",
       "      <td>8.48%</td>\n",
       "      <td>11.38%</td>\n",
       "      <td>13.92%</td>\n",
       "      <td>16.10%</td>\n",
       "      <td>20.32%</td>\n",
       "      <td>18.50%</td>\n",
       "      <td>0.35%</td>\n",
       "      <td>0.22%</td>\n",
       "      <td>0.10%</td>\n",
       "      <td>0.00%</td>\n",
       "      <td>0.00%</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>15</td>\n",
       "      <td>11.88%</td>\n",
       "      <td>9.61%</td>\n",
       "      <td>12.44%</td>\n",
       "      <td>15.75%</td>\n",
       "      <td>18.40%</td>\n",
       "      <td>19.60%</td>\n",
       "      <td>11.30%</td>\n",
       "      <td>0.57%</td>\n",
       "      <td>0.29%</td>\n",
       "      <td>0.15%</td>\n",
       "      <td>0.00%</td>\n",
       "      <td>0.00%</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>16</td>\n",
       "      <td>12.13%</td>\n",
       "      <td>9.78%</td>\n",
       "      <td>12.68%</td>\n",
       "      <td>16.04%</td>\n",
       "      <td>18.57%</td>\n",
       "      <td>19.46%</td>\n",
       "      <td>10.41%</td>\n",
       "      <td>0.51%</td>\n",
       "      <td>0.29%</td>\n",
       "      <td>0.12%</td>\n",
       "      <td>0.00%</td>\n",
       "      <td>0.00%</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>17</td>\n",
       "      <td>12.41%</td>\n",
       "      <td>9.95%</td>\n",
       "      <td>12.88%</td>\n",
       "      <td>16.34%</td>\n",
       "      <td>18.79%</td>\n",
       "      <td>19.35%</td>\n",
       "      <td>9.45%</td>\n",
       "      <td>0.46%</td>\n",
       "      <td>0.27%</td>\n",
       "      <td>0.10%</td>\n",
       "      <td>0.00%</td>\n",
       "      <td>0.00%</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>18</td>\n",
       "      <td>12.60%</td>\n",
       "      <td>10.15%</td>\n",
       "      <td>13.17%</td>\n",
       "      <td>16.47%</td>\n",
       "      <td>18.98%</td>\n",
       "      <td>19.11%</td>\n",
       "      <td>8.70%</td>\n",
       "      <td>0.47%</td>\n",
       "      <td>0.24%</td>\n",
       "      <td>0.09%</td>\n",
       "      <td>0.00%</td>\n",
       "      <td>0.03%</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    Period 0% - 30% 30% - 40% 40%-50% 50%-60% 60%-70% 70%-80% 80%-90% 90%-95%  \\\n",
       "0        0    8.52%     7.20%  10.18%  12.69%  16.40%  22.11%  22.13%   0.66%   \n",
       "1        1    8.63%     7.35%  10.20%  12.82%  16.67%  22.13%  21.49%   0.60%   \n",
       "2        2    8.83%     7.52%  10.24%  13.06%  16.82%  21.99%  20.90%   0.53%   \n",
       "3        3    9.02%     7.69%  10.44%  13.18%  17.22%  21.75%  20.21%   0.38%   \n",
       "4        4    9.39%     7.84%  10.87%  13.46%  16.42%  21.64%  20.01%   0.22%   \n",
       "5        5    9.66%     7.99%  11.02%  13.66%  16.75%  21.54%  19.05%   0.21%   \n",
       "6        6    9.97%     8.18%  11.19%  13.79%  16.87%  21.51%  18.18%   0.19%   \n",
       "7        7    9.67%     7.80%  10.96%  13.39%  16.04%  21.39%  20.09%   0.34%   \n",
       "8        8    9.87%     7.98%  11.20%  13.46%  16.38%  21.13%  19.37%   0.31%   \n",
       "9        9   10.04%     8.16%  11.40%  13.62%  16.54%  21.08%  18.59%   0.29%   \n",
       "10      10    9.05%     7.55%  10.67%  13.17%  16.15%  21.92%  20.98%   0.26%   \n",
       "11      11   12.90%    10.42%  13.40%  16.76%  19.18%  18.86%   7.77%   0.40%   \n",
       "12      12   13.18%    10.57%  13.77%  17.02%  19.36%  18.47%   7.01%   0.35%   \n",
       "13      13   10.36%     8.38%  11.05%  13.79%  16.03%  20.29%  19.34%   0.41%   \n",
       "14      14   10.64%     8.48%  11.38%  13.92%  16.10%  20.32%  18.50%   0.35%   \n",
       "15      15   11.88%     9.61%  12.44%  15.75%  18.40%  19.60%  11.30%   0.57%   \n",
       "16      16   12.13%     9.78%  12.68%  16.04%  18.57%  19.46%  10.41%   0.51%   \n",
       "17      17   12.41%     9.95%  12.88%  16.34%  18.79%  19.35%   9.45%   0.46%   \n",
       "18      18   12.60%    10.15%  13.17%  16.47%  18.98%  19.11%   8.70%   0.47%   \n",
       "\n",
       "   95% - 100% 100% - 125% 125% - 150%   150%  \n",
       "0       0.08%       0.03%       0.00%  0.00%  \n",
       "1       0.08%       0.04%       0.00%  0.00%  \n",
       "2       0.08%       0.04%       0.00%  0.00%  \n",
       "3       0.08%       0.03%       0.00%  0.00%  \n",
       "4       0.10%       0.05%       0.00%  0.00%  \n",
       "5       0.10%       0.03%       0.00%  0.00%  \n",
       "6       0.10%       0.02%       0.00%  0.00%  \n",
       "7       0.24%       0.08%       0.00%  0.00%  \n",
       "8       0.22%       0.08%       0.00%  0.00%  \n",
       "9       0.21%       0.08%       0.00%  0.00%  \n",
       "10      0.18%       0.06%       0.00%  0.00%  \n",
       "11      0.22%       0.08%       0.00%  0.00%  \n",
       "12      0.20%       0.07%       0.00%  0.00%  \n",
       "13      0.21%       0.13%       0.00%  0.00%  \n",
       "14      0.22%       0.10%       0.00%  0.00%  \n",
       "15      0.29%       0.15%       0.00%  0.00%  \n",
       "16      0.29%       0.12%       0.00%  0.00%  \n",
       "17      0.27%       0.10%       0.00%  0.00%  \n",
       "18      0.24%       0.09%       0.00%  0.03%  "
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import PyPDF2 as p2\n",
    "import re\n",
    "import pandas as pd\n",
    "import seaborn as sns\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "\n",
    "#For 2020 - 2015 (exception being Q1 of 2019)\n",
    "#TODO: Create function to read PDF for table 1, scrape into list\n",
    "def get_table_2_list (year):\n",
    "    file = open(\"{}.pdf\".format(year), \"rb\") \n",
    "    PDFfile = p2.PdfFileReader(file)\n",
    "    page_1 = PDFfile.getPage(0)\n",
    "    Table_2 = page_1.extractText()\n",
    "    table_2_list = re.sub(' +', ' ', Table_2.replace('\\n', ' ')).split('Loans % of Total')\n",
    "    if len(table_2_list) != 1:  \n",
    "        table_2_list_cleaned = table_2_list[1].split(' ')\n",
    "        table_2_list_cleaned.insert(68, ' ')\n",
    "    else:\n",
    "        table_2_list_cleaned = table_2_list[0].split(' ')\n",
    "        table_2_list_cleaned.insert(68, ' ')\n",
    "    return table_2_list_cleaned\n",
    "\n",
    "#TODO: Create function that generates DF.\n",
    "def create_df(year):\n",
    "    table_2_df = pd.DataFrame({\n",
    "            '>':[],\n",
    "            '<=':[],\n",
    "            'Current Balance (Euros)': [],\n",
    "            '% of Total': [],\n",
    "            'No. of Loans': []\n",
    "        })\n",
    "    row_section = 1\n",
    "    for i in range(0,12): \n",
    "        table_2_df.loc[i] = get_table_2_list(year)[row_section:(row_section + 5)]\n",
    "        row_section += 6\n",
    "    return table_2_df\n",
    "\n",
    "#TODO: Create function for % of total time series\n",
    "def of_total(year):\n",
    "    table_2_df = pd.DataFrame({\n",
    "            '>':[],\n",
    "            '<=':[],\n",
    "            'Current Balance (Euros)': [],\n",
    "            '% of Total': [],\n",
    "            'No. of Loans': []\n",
    "        })\n",
    "    row_section = 1\n",
    "    for i in range(0,12): \n",
    "        table_2_df.loc[i] = get_table_2_list(year)[row_section:(row_section + 5)]\n",
    "        row_section += 6\n",
    "    table_2_df = table_2_df.drop(columns = ['>', '<=', 'Current Balance (Euros)', 'No. of Loans']).transpose()\n",
    "    return table_2_df\n",
    "\n",
    "# Omitted 201901, \n",
    "df = of_total(202001).append([of_total(202002), of_total(202003), of_total(202004)\n",
    "                                 , of_total(201902), of_total(201903)\n",
    "                                 , of_total(201904), of_total(201801), of_total(201802)\n",
    "                                 , of_total(201803), of_total(2018_04), of_total(201701)\n",
    "                                 , of_total(201702), of_total(201703), of_total(201704)\n",
    "                                 , of_total(201601), of_total(201602), of_total(201603)\n",
    "                                 , of_total(201604)\n",
    "                                 ]).reset_index()\n",
    "\n",
    "df = df.drop('index', axis = 1).reset_index()\n",
    "df.columns = df.columns.map(str)\n",
    "df.columns = ['Period', '0% - 30%', '30% - 40%', '40%-50%', '50%-60%', '60%-70%', '70%-80%','80%-90%', '90%-95%', '95% - 100%',\n",
    "             '100% - 125%', '125% - 150%', '150%']\n",
    "df.head(50)\n",
    "\n",
    "\n",
    "# Due to certain PDFs prior to 2016 being formatted differently and posing challenges to scraping, we preprocess and enter\n",
    "# The data manually and import the data back. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Period</th>\n",
       "      <th>0% - 30%</th>\n",
       "      <th>30% - 40%</th>\n",
       "      <th>40%-50%</th>\n",
       "      <th>50%-60%</th>\n",
       "      <th>60%-70%</th>\n",
       "      <th>70%-80%</th>\n",
       "      <th>80%-90%</th>\n",
       "      <th>90%-95%</th>\n",
       "      <th>95% - 100%</th>\n",
       "      <th>100% - 125%</th>\n",
       "      <th>125% - 150%</th>\n",
       "      <th>150%</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>22,951</td>\n",
       "      <td>9,199</td>\n",
       "      <td>9,924</td>\n",
       "      <td>9,995</td>\n",
       "      <td>11,037</td>\n",
       "      <td>13,486</td>\n",
       "      <td>12,426</td>\n",
       "      <td>310</td>\n",
       "      <td>33</td>\n",
       "      <td>20</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>22,418</td>\n",
       "      <td>9,181</td>\n",
       "      <td>9,712</td>\n",
       "      <td>9,916</td>\n",
       "      <td>11,032</td>\n",
       "      <td>13,260</td>\n",
       "      <td>11,832</td>\n",
       "      <td>270</td>\n",
       "      <td>32</td>\n",
       "      <td>25</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>22,434</td>\n",
       "      <td>9,071</td>\n",
       "      <td>9,591</td>\n",
       "      <td>9,835</td>\n",
       "      <td>10,945</td>\n",
       "      <td>12,931</td>\n",
       "      <td>11,209</td>\n",
       "      <td>238</td>\n",
       "      <td>27</td>\n",
       "      <td>26</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>22,106</td>\n",
       "      <td>8,965</td>\n",
       "      <td>9,381</td>\n",
       "      <td>9,649</td>\n",
       "      <td>10,870</td>\n",
       "      <td>12,515</td>\n",
       "      <td>10,472</td>\n",
       "      <td>165</td>\n",
       "      <td>30</td>\n",
       "      <td>20</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>22,268</td>\n",
       "      <td>8,845</td>\n",
       "      <td>9,511</td>\n",
       "      <td>9,432</td>\n",
       "      <td>9,886</td>\n",
       "      <td>11,635</td>\n",
       "      <td>10,309</td>\n",
       "      <td>104</td>\n",
       "      <td>35</td>\n",
       "      <td>26</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>5</td>\n",
       "      <td>22,236</td>\n",
       "      <td>8,739</td>\n",
       "      <td>9,361</td>\n",
       "      <td>9,322</td>\n",
       "      <td>9,782</td>\n",
       "      <td>11,371</td>\n",
       "      <td>9,551</td>\n",
       "      <td>101</td>\n",
       "      <td>31</td>\n",
       "      <td>19</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>6</td>\n",
       "      <td>22,231</td>\n",
       "      <td>8,773</td>\n",
       "      <td>9,283</td>\n",
       "      <td>9,163</td>\n",
       "      <td>9,633</td>\n",
       "      <td>11,103</td>\n",
       "      <td>8,868</td>\n",
       "      <td>94</td>\n",
       "      <td>32</td>\n",
       "      <td>12</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>7</td>\n",
       "      <td>22,248</td>\n",
       "      <td>8,791</td>\n",
       "      <td>9,430</td>\n",
       "      <td>9,325</td>\n",
       "      <td>9,485</td>\n",
       "      <td>10,944</td>\n",
       "      <td>10,489</td>\n",
       "      <td>148</td>\n",
       "      <td>86</td>\n",
       "      <td>36</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>8</td>\n",
       "      <td>22,166</td>\n",
       "      <td>8,717</td>\n",
       "      <td>9,428</td>\n",
       "      <td>9,146</td>\n",
       "      <td>9,450</td>\n",
       "      <td>10,679</td>\n",
       "      <td>9,903</td>\n",
       "      <td>138</td>\n",
       "      <td>75</td>\n",
       "      <td>33</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>9</td>\n",
       "      <td>22,056</td>\n",
       "      <td>8,726</td>\n",
       "      <td>9,289</td>\n",
       "      <td>9,037</td>\n",
       "      <td>9,310</td>\n",
       "      <td>10,480</td>\n",
       "      <td>9,284</td>\n",
       "      <td>125</td>\n",
       "      <td>70</td>\n",
       "      <td>31</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>10</td>\n",
       "      <td>22,790</td>\n",
       "      <td>9,030</td>\n",
       "      <td>9,760</td>\n",
       "      <td>9,722</td>\n",
       "      <td>10,292</td>\n",
       "      <td>12,185</td>\n",
       "      <td>11,364</td>\n",
       "      <td>134</td>\n",
       "      <td>65</td>\n",
       "      <td>38</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>11</td>\n",
       "      <td>28,120</td>\n",
       "      <td>10,982</td>\n",
       "      <td>10,938</td>\n",
       "      <td>10,920</td>\n",
       "      <td>10,349</td>\n",
       "      <td>8,864</td>\n",
       "      <td>3,751</td>\n",
       "      <td>160</td>\n",
       "      <td>59</td>\n",
       "      <td>22</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>12</td>\n",
       "      <td>28,014</td>\n",
       "      <td>10,850</td>\n",
       "      <td>10,902</td>\n",
       "      <td>10,811</td>\n",
       "      <td>10,130</td>\n",
       "      <td>8,520</td>\n",
       "      <td>3,371</td>\n",
       "      <td>134</td>\n",
       "      <td>53</td>\n",
       "      <td>22</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>13</td>\n",
       "      <td>21,757</td>\n",
       "      <td>8,658</td>\n",
       "      <td>8,922</td>\n",
       "      <td>8,817</td>\n",
       "      <td>8,699</td>\n",
       "      <td>9,460</td>\n",
       "      <td>9,386</td>\n",
       "      <td>158</td>\n",
       "      <td>59</td>\n",
       "      <td>49</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>14</td>\n",
       "      <td>21,901</td>\n",
       "      <td>8,549</td>\n",
       "      <td>8,927</td>\n",
       "      <td>8,697</td>\n",
       "      <td>8,507</td>\n",
       "      <td>9,306</td>\n",
       "      <td>8,825</td>\n",
       "      <td>129</td>\n",
       "      <td>60</td>\n",
       "      <td>37</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>15</td>\n",
       "      <td>28,810</td>\n",
       "      <td>11,276</td>\n",
       "      <td>11,353</td>\n",
       "      <td>11,554</td>\n",
       "      <td>11,059</td>\n",
       "      <td>10,036</td>\n",
       "      <td>5,741</td>\n",
       "      <td>229</td>\n",
       "      <td>97</td>\n",
       "      <td>46</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>16</td>\n",
       "      <td>28,183</td>\n",
       "      <td>11,184</td>\n",
       "      <td>11,244</td>\n",
       "      <td>11,421</td>\n",
       "      <td>10,876</td>\n",
       "      <td>9,763</td>\n",
       "      <td>5,222</td>\n",
       "      <td>202</td>\n",
       "      <td>95</td>\n",
       "      <td>35</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>17</td>\n",
       "      <td>28,241</td>\n",
       "      <td>11,140</td>\n",
       "      <td>11,088</td>\n",
       "      <td>11,238</td>\n",
       "      <td>10,723</td>\n",
       "      <td>9,480</td>\n",
       "      <td>4,698</td>\n",
       "      <td>185</td>\n",
       "      <td>83</td>\n",
       "      <td>29</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>18</td>\n",
       "      <td>28,156</td>\n",
       "      <td>11,087</td>\n",
       "      <td>10,980</td>\n",
       "      <td>11,055</td>\n",
       "      <td>10,523</td>\n",
       "      <td>9,182</td>\n",
       "      <td>4,244</td>\n",
       "      <td>183</td>\n",
       "      <td>70</td>\n",
       "      <td>24</td>\n",
       "      <td>1</td>\n",
       "      <td>29</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    Period 0% - 30% 30% - 40% 40%-50% 50%-60% 60%-70% 70%-80% 80%-90% 90%-95%  \\\n",
       "0        0   22,951     9,199   9,924   9,995  11,037  13,486  12,426     310   \n",
       "1        1   22,418     9,181   9,712   9,916  11,032  13,260  11,832     270   \n",
       "2        2   22,434     9,071   9,591   9,835  10,945  12,931  11,209     238   \n",
       "3        3   22,106     8,965   9,381   9,649  10,870  12,515  10,472     165   \n",
       "4        4   22,268     8,845   9,511   9,432   9,886  11,635  10,309     104   \n",
       "5        5   22,236     8,739   9,361   9,322   9,782  11,371   9,551     101   \n",
       "6        6   22,231     8,773   9,283   9,163   9,633  11,103   8,868      94   \n",
       "7        7   22,248     8,791   9,430   9,325   9,485  10,944  10,489     148   \n",
       "8        8   22,166     8,717   9,428   9,146   9,450  10,679   9,903     138   \n",
       "9        9   22,056     8,726   9,289   9,037   9,310  10,480   9,284     125   \n",
       "10      10   22,790     9,030   9,760   9,722  10,292  12,185  11,364     134   \n",
       "11      11   28,120    10,982  10,938  10,920  10,349   8,864   3,751     160   \n",
       "12      12   28,014    10,850  10,902  10,811  10,130   8,520   3,371     134   \n",
       "13      13   21,757     8,658   8,922   8,817   8,699   9,460   9,386     158   \n",
       "14      14   21,901     8,549   8,927   8,697   8,507   9,306   8,825     129   \n",
       "15      15   28,810    11,276  11,353  11,554  11,059  10,036   5,741     229   \n",
       "16      16   28,183    11,184  11,244  11,421  10,876   9,763   5,222     202   \n",
       "17      17   28,241    11,140  11,088  11,238  10,723   9,480   4,698     185   \n",
       "18      18   28,156    11,087  10,980  11,055  10,523   9,182   4,244     183   \n",
       "\n",
       "   95% - 100% 100% - 125% 125% - 150% 150%  \n",
       "0          33          20           0    0  \n",
       "1          32          25           0    0  \n",
       "2          27          26           0    0  \n",
       "3          30          20           0    0  \n",
       "4          35          26           0    0  \n",
       "5          31          19           0    0  \n",
       "6          32          12           0    0  \n",
       "7          86          36           0    0  \n",
       "8          75          33           0    0  \n",
       "9          70          31           0    0  \n",
       "10         65          38           0    2  \n",
       "11         59          22           0    0  \n",
       "12         53          22           0    0  \n",
       "13         59          49           0    1  \n",
       "14         60          37           0    0  \n",
       "15         97          46           0    1  \n",
       "16         95          35           0    3  \n",
       "17         83          29           0    0  \n",
       "18         70          24           1   29  "
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "def current_balance(year):\n",
    "    table_2_df = pd.DataFrame({\n",
    "            '>':[],\n",
    "            '<=':[],\n",
    "            'Current Balance (Euros)': [],\n",
    "            '% of Total': [],\n",
    "            'No. of Loans': []\n",
    "        })\n",
    "    row_section = 1\n",
    "    for i in range(0,12): \n",
    "        table_2_df.loc[i] = get_table_2_list(year)[row_section:(row_section + 5)]\n",
    "        row_section += 6\n",
    "    table_2_df = table_2_df.drop(columns = ['>', '<=', '% of Total', 'Current Balance (Euros)']).transpose()\n",
    "    return table_2_df\n",
    "\n",
    "# Omitted 201901, \n",
    "df1 = current_balance(202001).append([current_balance(202002), current_balance(202003), current_balance(202004)\n",
    "                                 , current_balance(201902), current_balance(201903)\n",
    "                                 , current_balance(201904), current_balance(201801), current_balance(201802)\n",
    "                                 , current_balance(201803), current_balance(2018_04), current_balance(201701)\n",
    "                                 , current_balance(201702), current_balance(201703), current_balance(201704)\n",
    "                                 , current_balance(201601), current_balance(201602), current_balance(201603)\n",
    "                                 , current_balance(201604)\n",
    "                                 ]).reset_index()\n",
    "\n",
    "df1 = df1.drop('index', axis = 1).reset_index()\n",
    "df1.columns = df1.columns.map(str)\n",
    "df1.columns = ['Period', '0% - 30%', '30% - 40%', '40%-50%', '50%-60%', '60%-70%', '70%-80%','80%-90%', '90%-95%', '95% - 100%',\n",
    "             '100% - 125%', '125% - 150%', '150%']\n",
    "df1.head(50)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Period</th>\n",
       "      <th>0% - 30%</th>\n",
       "      <th>30% - 40%</th>\n",
       "      <th>40%-50%</th>\n",
       "      <th>50%-60%</th>\n",
       "      <th>60%-70%</th>\n",
       "      <th>70%-80%</th>\n",
       "      <th>80%-90%</th>\n",
       "      <th>90%-95%</th>\n",
       "      <th>95% - 100%</th>\n",
       "      <th>100% - 125%</th>\n",
       "      <th>125% - 150%</th>\n",
       "      <th>150%</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>22,951</td>\n",
       "      <td>9,199</td>\n",
       "      <td>9,924</td>\n",
       "      <td>9,995</td>\n",
       "      <td>11,037</td>\n",
       "      <td>13,486</td>\n",
       "      <td>12,426</td>\n",
       "      <td>310</td>\n",
       "      <td>33</td>\n",
       "      <td>20</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>22,418</td>\n",
       "      <td>9,181</td>\n",
       "      <td>9,712</td>\n",
       "      <td>9,916</td>\n",
       "      <td>11,032</td>\n",
       "      <td>13,260</td>\n",
       "      <td>11,832</td>\n",
       "      <td>270</td>\n",
       "      <td>32</td>\n",
       "      <td>25</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>22,434</td>\n",
       "      <td>9,071</td>\n",
       "      <td>9,591</td>\n",
       "      <td>9,835</td>\n",
       "      <td>10,945</td>\n",
       "      <td>12,931</td>\n",
       "      <td>11,209</td>\n",
       "      <td>238</td>\n",
       "      <td>27</td>\n",
       "      <td>26</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>22,106</td>\n",
       "      <td>8,965</td>\n",
       "      <td>9,381</td>\n",
       "      <td>9,649</td>\n",
       "      <td>10,870</td>\n",
       "      <td>12,515</td>\n",
       "      <td>10,472</td>\n",
       "      <td>165</td>\n",
       "      <td>30</td>\n",
       "      <td>20</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>22,268</td>\n",
       "      <td>8,845</td>\n",
       "      <td>9,511</td>\n",
       "      <td>9,432</td>\n",
       "      <td>9,886</td>\n",
       "      <td>11,635</td>\n",
       "      <td>10,309</td>\n",
       "      <td>104</td>\n",
       "      <td>35</td>\n",
       "      <td>26</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>5</td>\n",
       "      <td>22,236</td>\n",
       "      <td>8,739</td>\n",
       "      <td>9,361</td>\n",
       "      <td>9,322</td>\n",
       "      <td>9,782</td>\n",
       "      <td>11,371</td>\n",
       "      <td>9,551</td>\n",
       "      <td>101</td>\n",
       "      <td>31</td>\n",
       "      <td>19</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>6</td>\n",
       "      <td>22,231</td>\n",
       "      <td>8,773</td>\n",
       "      <td>9,283</td>\n",
       "      <td>9,163</td>\n",
       "      <td>9,633</td>\n",
       "      <td>11,103</td>\n",
       "      <td>8,868</td>\n",
       "      <td>94</td>\n",
       "      <td>32</td>\n",
       "      <td>12</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>7</td>\n",
       "      <td>22,248</td>\n",
       "      <td>8,791</td>\n",
       "      <td>9,430</td>\n",
       "      <td>9,325</td>\n",
       "      <td>9,485</td>\n",
       "      <td>10,944</td>\n",
       "      <td>10,489</td>\n",
       "      <td>148</td>\n",
       "      <td>86</td>\n",
       "      <td>36</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>8</td>\n",
       "      <td>22,166</td>\n",
       "      <td>8,717</td>\n",
       "      <td>9,428</td>\n",
       "      <td>9,146</td>\n",
       "      <td>9,450</td>\n",
       "      <td>10,679</td>\n",
       "      <td>9,903</td>\n",
       "      <td>138</td>\n",
       "      <td>75</td>\n",
       "      <td>33</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>9</td>\n",
       "      <td>22,056</td>\n",
       "      <td>8,726</td>\n",
       "      <td>9,289</td>\n",
       "      <td>9,037</td>\n",
       "      <td>9,310</td>\n",
       "      <td>10,480</td>\n",
       "      <td>9,284</td>\n",
       "      <td>125</td>\n",
       "      <td>70</td>\n",
       "      <td>31</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>10</td>\n",
       "      <td>22,790</td>\n",
       "      <td>9,030</td>\n",
       "      <td>9,760</td>\n",
       "      <td>9,722</td>\n",
       "      <td>10,292</td>\n",
       "      <td>12,185</td>\n",
       "      <td>11,364</td>\n",
       "      <td>134</td>\n",
       "      <td>65</td>\n",
       "      <td>38</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>11</td>\n",
       "      <td>28,120</td>\n",
       "      <td>10,982</td>\n",
       "      <td>10,938</td>\n",
       "      <td>10,920</td>\n",
       "      <td>10,349</td>\n",
       "      <td>8,864</td>\n",
       "      <td>3,751</td>\n",
       "      <td>160</td>\n",
       "      <td>59</td>\n",
       "      <td>22</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>12</td>\n",
       "      <td>28,014</td>\n",
       "      <td>10,850</td>\n",
       "      <td>10,902</td>\n",
       "      <td>10,811</td>\n",
       "      <td>10,130</td>\n",
       "      <td>8,520</td>\n",
       "      <td>3,371</td>\n",
       "      <td>134</td>\n",
       "      <td>53</td>\n",
       "      <td>22</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>13</td>\n",
       "      <td>21,757</td>\n",
       "      <td>8,658</td>\n",
       "      <td>8,922</td>\n",
       "      <td>8,817</td>\n",
       "      <td>8,699</td>\n",
       "      <td>9,460</td>\n",
       "      <td>9,386</td>\n",
       "      <td>158</td>\n",
       "      <td>59</td>\n",
       "      <td>49</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>14</td>\n",
       "      <td>21,901</td>\n",
       "      <td>8,549</td>\n",
       "      <td>8,927</td>\n",
       "      <td>8,697</td>\n",
       "      <td>8,507</td>\n",
       "      <td>9,306</td>\n",
       "      <td>8,825</td>\n",
       "      <td>129</td>\n",
       "      <td>60</td>\n",
       "      <td>37</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>15</td>\n",
       "      <td>28,810</td>\n",
       "      <td>11,276</td>\n",
       "      <td>11,353</td>\n",
       "      <td>11,554</td>\n",
       "      <td>11,059</td>\n",
       "      <td>10,036</td>\n",
       "      <td>5,741</td>\n",
       "      <td>229</td>\n",
       "      <td>97</td>\n",
       "      <td>46</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>16</td>\n",
       "      <td>28,183</td>\n",
       "      <td>11,184</td>\n",
       "      <td>11,244</td>\n",
       "      <td>11,421</td>\n",
       "      <td>10,876</td>\n",
       "      <td>9,763</td>\n",
       "      <td>5,222</td>\n",
       "      <td>202</td>\n",
       "      <td>95</td>\n",
       "      <td>35</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>17</td>\n",
       "      <td>28,241</td>\n",
       "      <td>11,140</td>\n",
       "      <td>11,088</td>\n",
       "      <td>11,238</td>\n",
       "      <td>10,723</td>\n",
       "      <td>9,480</td>\n",
       "      <td>4,698</td>\n",
       "      <td>185</td>\n",
       "      <td>83</td>\n",
       "      <td>29</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>18</td>\n",
       "      <td>28,156</td>\n",
       "      <td>11,087</td>\n",
       "      <td>10,980</td>\n",
       "      <td>11,055</td>\n",
       "      <td>10,523</td>\n",
       "      <td>9,182</td>\n",
       "      <td>4,244</td>\n",
       "      <td>183</td>\n",
       "      <td>70</td>\n",
       "      <td>24</td>\n",
       "      <td>1</td>\n",
       "      <td>29</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    Period 0% - 30% 30% - 40% 40%-50% 50%-60% 60%-70% 70%-80% 80%-90% 90%-95%  \\\n",
       "0        0   22,951     9,199   9,924   9,995  11,037  13,486  12,426     310   \n",
       "1        1   22,418     9,181   9,712   9,916  11,032  13,260  11,832     270   \n",
       "2        2   22,434     9,071   9,591   9,835  10,945  12,931  11,209     238   \n",
       "3        3   22,106     8,965   9,381   9,649  10,870  12,515  10,472     165   \n",
       "4        4   22,268     8,845   9,511   9,432   9,886  11,635  10,309     104   \n",
       "5        5   22,236     8,739   9,361   9,322   9,782  11,371   9,551     101   \n",
       "6        6   22,231     8,773   9,283   9,163   9,633  11,103   8,868      94   \n",
       "7        7   22,248     8,791   9,430   9,325   9,485  10,944  10,489     148   \n",
       "8        8   22,166     8,717   9,428   9,146   9,450  10,679   9,903     138   \n",
       "9        9   22,056     8,726   9,289   9,037   9,310  10,480   9,284     125   \n",
       "10      10   22,790     9,030   9,760   9,722  10,292  12,185  11,364     134   \n",
       "11      11   28,120    10,982  10,938  10,920  10,349   8,864   3,751     160   \n",
       "12      12   28,014    10,850  10,902  10,811  10,130   8,520   3,371     134   \n",
       "13      13   21,757     8,658   8,922   8,817   8,699   9,460   9,386     158   \n",
       "14      14   21,901     8,549   8,927   8,697   8,507   9,306   8,825     129   \n",
       "15      15   28,810    11,276  11,353  11,554  11,059  10,036   5,741     229   \n",
       "16      16   28,183    11,184  11,244  11,421  10,876   9,763   5,222     202   \n",
       "17      17   28,241    11,140  11,088  11,238  10,723   9,480   4,698     185   \n",
       "18      18   28,156    11,087  10,980  11,055  10,523   9,182   4,244     183   \n",
       "\n",
       "   95% - 100% 100% - 125% 125% - 150% 150%  \n",
       "0          33          20           0    0  \n",
       "1          32          25           0    0  \n",
       "2          27          26           0    0  \n",
       "3          30          20           0    0  \n",
       "4          35          26           0    0  \n",
       "5          31          19           0    0  \n",
       "6          32          12           0    0  \n",
       "7          86          36           0    0  \n",
       "8          75          33           0    0  \n",
       "9          70          31           0    0  \n",
       "10         65          38           0    2  \n",
       "11         59          22           0    0  \n",
       "12         53          22           0    0  \n",
       "13         59          49           0    1  \n",
       "14         60          37           0    0  \n",
       "15         97          46           0    1  \n",
       "16         95          35           0    3  \n",
       "17         83          29           0    0  \n",
       "18         70          24           1   29  "
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "def No_of_loans(year):\n",
    "    table_2_df = pd.DataFrame({\n",
    "            '>':[],\n",
    "            '<=':[],\n",
    "            'Current Balance (Euros)': [],\n",
    "            '% of Total': [],\n",
    "            'No. of Loans': []\n",
    "        })\n",
    "    row_section = 1\n",
    "    for i in range(0,12): \n",
    "        table_2_df.loc[i] = get_table_2_list(year)[row_section:(row_section + 5)]\n",
    "        row_section += 6\n",
    "    table_2_df = table_2_df.drop(columns = ['>', '<=', '% of Total', 'Current Balance (Euros)']).transpose()\n",
    "    return table_2_df\n",
    "\n",
    "# Omitted 201901, \n",
    "df2 = No_of_loans(202001).append([No_of_loans(202002), No_of_loans(202003), No_of_loans(202004)\n",
    "                                 , No_of_loans(201902), No_of_loans(201903)\n",
    "                                 , No_of_loans(201904), No_of_loans(201801), No_of_loans(201802)\n",
    "                                 , No_of_loans(201803), No_of_loans(2018_04), No_of_loans(201701)\n",
    "                                 , No_of_loans(201702), No_of_loans(201703), No_of_loans(201704)\n",
    "                                 , No_of_loans(201601), No_of_loans(201602), No_of_loans(201603)\n",
    "                                 , No_of_loans(201604)\n",
    "                                 ]).reset_index()\n",
    "\n",
    "df2 = df2.drop('index', axis = 1).reset_index()\n",
    "df2.columns = df2.columns.map(str)\n",
    "df2.columns = ['Period', '0% - 30%', '30% - 40%', '40%-50%', '50%-60%', '60%-70%', '70%-80%','80%-90%', '90%-95%', '95% - 100%',\n",
    "             '100% - 125%', '125% - 150%', '150%']\n",
    "df2.head(50)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [],
   "source": [
    "df.to_excel(r'C:\\Users\\Danny\\Desktop\\Course Files\\ECO352\\total_%_data.xlsx', index = False)\n",
    "df1.to_excel(r'C:\\Users\\Danny\\Desktop\\Course Files\\ECO352\\current_balance_%_data.xlsx', index = False)\n",
    "df2.to_excel(r'C:\\Users\\Danny\\Desktop\\Course Files\\ECO352\\No_of_loans_data.xlsx', index = False)"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
